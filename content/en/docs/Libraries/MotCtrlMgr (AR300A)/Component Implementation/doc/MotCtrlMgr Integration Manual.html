---
title: MotCtrlMgr Integration Manual
linkTitle: MotCtrlMgr Integration Manual
weight: 2
---

<p><strong>Integration Manual</strong></p>
<p><strong>For</strong></p>
<p><strong>MotCtrlMgr</strong></p>
<p><strong>VERSION: 3</strong></p>
<p><strong>DATE:</strong> <strong>09/21/16</strong></p>
<p><strong>Prepared By:</strong></p>
<p><strong>Software Group,</strong></p>
<p><strong>Nexteer Automotive,</strong></p>
<p><strong>Saginaw, MI, USA</strong></p>
<p><strong>Location:</strong> The official version of this document is stored in the Nexteer Configuration Management System.</p>
<p><strong>Revision History</strong></p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 27%" />
<col style="width: 27%" />
<col style="width: 10%" />
<col style="width: 28%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Sl. No.</strong></td>
<td><strong>Description</strong></td>
<td><strong>Author</strong></td>
<td><strong>Version</strong></td>
<td><strong>Date</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>Initial version</td>
<td>Lucas Wendling</td>
<td>1</td>
<td>05/29/15</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Updates for Signal Mapping</td>
<td>Lucas Wendling</td>
<td>2</td>
<td>10/28/15</td>
</tr>
<tr class="even">
<td>3</td>
<td>Updates describing tool that generates MotCtrlMgr configuration</td>
<td>Lucas Wendling</td>
<td>3</td>
<td>09/21/16</td>
</tr>
</tbody>
</table>
<p>Table of Contents</p>
<p><a href="#abbrevations-and-acronyms">1 Abbrevations And Acronyms 4</a></p>
<p><a href="#references">2 References 5</a></p>
<p><a href="#dependencies">3 Dependencies 6</a></p>
<p><a href="#swcs">3.1 SWCs 6</a></p>
<p><a href="#global-functionsnon-rte-to-be-provided-to-integration-project">3.2 Global Functions(Non RTE) to be provided to Integration Project 6</a></p>
<p><a href="#configuration-requirements">4 Configuration REQUIREMeNTS 7</a></p>
<p><a href="#build-time-config">4.1 Build Time Config 7</a></p>
<p><a href="#configuration-files-to-be-provided-by-integration-project">4.2 Configuration Files to be provided by Integration Project 7</a></p>
<p><a href="#davinci-parameter-configuration-changes">4.3 Da Vinci Parameter Configuration Changes 7</a></p>
<p><a href="#__RefHeading___Toc389222325">4.4 DaVinci Interrupt Configuration Changes 7</a></p>
<p><a href="#manual-configuration-changes">4.5 Manual Configuration Changes 7</a></p>
<p><a href="#integration-dataflow-requirements">5 Integration DATAFLOW REQUIREMENTS 8</a></p>
<p><a href="#required-global-data-inputs">5.1 Required Global Data Inputs 8</a></p>
<p><a href="#required-global-data-outputs">5.2 Required Global Data Outputs 8</a></p>
<p><a href="#specific-include-path-present">5.3 Specific Include Path present 8</a></p>
<p><a href="#runnable-scheduling">6 Runnable Scheduling 9</a></p>
<p><a href="#memory-map-requirements">7 Memory Map REQUIREMENTS 10</a></p>
<p><a href="#mapping">7.1 Mapping 10</a></p>
<p><a href="#usage">7.2 Usage 10</a></p>
<p><a href="#nvm-blocks">7.3 Non RTE NvM Blocks 10</a></p>
<p><a href="#__RefHeading___Toc389222336">7.4 RTE NvM Blocks 10</a></p>
<p><a href="#compiler-settings">8 Compiler Settings 11</a></p>
<p><a href="#preprocessor-macro">8.1 Preprocessor MACRO 11</a></p>
<p><a href="#optimization-settings">8.2 Optimization Settings 11</a></p>
<p><a href="#appendix">9 Appendix 12</a></p>
<h1 id="abbrevations-and-acronyms">Abbrevations And Acronyms</h1>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 71%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Abbreviation</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="even">
<td>DFD</td>
<td>Design functional diagram</td>
</tr>
<tr class="odd">
<td>MDD</td>
<td>Module design Document</td>
</tr>
<tr class="even">
<td></td>
<td>&lt;ADD more to the table if applicable&gt;</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="references">References</h1>
<p>This section lists the title &amp; version of all the documents that are referred for development of this document</p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 65%" />
<col style="width: 22%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Sr. No.</strong></td>
<td><strong>Title</strong></td>
<td><strong>Version</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>MDD Guidelines</td>
<td>Process 04.00.00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Software Naming Conventions</td>
<td>Process 04.00.00</td>
</tr>
<tr class="even">
<td>3</td>
<td>Software Coding Standards</td>
<td>Process 04.00.00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>AR300A_MotCtrlMgr_Design</td>
<td>See Synergy subproject version</td>
</tr>
</tbody>
</table>
<h1 id="dependencies">Dependencies</h1>
<h2 id="swcs">SWCs</h2>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 69%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Module</strong></td>
<td><strong>Required Feature</strong></td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Note : Referencing the external components should be avoided in most cases. Only in unavoidable circumstance external components should be referred. Developer should track the references.</p>
<h2 id="global-functionsnon-rte-to-be-provided-to-integration-project">Global Functions(Non RTE) to be provided to Integration Project</h2>
<p>MotCtrlMgrIrq – This is a category 1 interrupt (see details below)</p>
<h1 id="configuration-requirements">Configuration REQUIREMeNTS</h1>
<p>In addition to configuration based .c and .h files, the MotCtrlMgr generator will also generate a .m file data dictionary for MotCtrlMgr. In addition to documentation purposes, this data dictionary is intended to aid in the creation of the AUTOSAR SWC model that is required to be created for the MotCtrlMgr’s signal interface to the RTE. While the generator will create the RTE runnables and runnable contents automatically, the SWC model to be used in the AUTOSAR authoring tools (e.g. Davinci Developer) is not automatically created by the generator and will need either a separate tool to create, or will need to be manually created.</p>
<h2 id="build-time-config">Build Time Config</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 36%" />
<col style="width: 53%" />
<col style="width: 9%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Modules</strong></td>
<td><strong>Notes</strong></td>
<td></td>
</tr>
<tr class="even">
<td><strong>None</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="configuration-files-to-be-provided-by-integration-project">Configuration Files to be provided by Integration Project</h2>
<p>CDD_MotCtrlMgr.c</p>
<p>CDD_MotCtrlMgr_Data.c</p>
<p>CDD_MotCtrlMgr_Data.h</p>
<p>CDD_MotCtrlMgr_Irq.c</p>
<h2 id="davinci-parameter-configuration-changes">DaVinci Parameter Configuration Changes</h2>
<p>Most of the configuration parameters in the table below are determined from extracted data from the component data dictionaries of a given project. This includes all of the motor control related runnables as well as all of the signals that interface to motor control related runnables (on either sender or receiver side).</p>
<p>The DataDictionary tool has been updated to support generation of the majority of the MotCtrlMgr configuration listed below. The inputs this tool requires is a project’s collection of component DataDictionaries, a signal mapping xml, as well as the latest FDD tool data management folder. The DataDictionary tool currently generates a .arxml file with all of the MotCtrlMgr configuration except the following parameters which still need to be manually populated:</p>
<p>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/RunnableManagement/IncludeHeaders</p>
<p>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/RunnableManagement/Runnable/SequenceOrder</p>
<p>The DataDictionary tool version which was used for testing of this component is embedded within this component’s baseline. This particular version of the tool is included mostly for reference purposes, and isn’t required to be used at an integration level for the actual generation of the MotCtrlMgr configuration so long as the version that is being used produces the correct output. </p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 54%" />
<col style="width: 12%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Parameter</strong></td>
<td><strong>Notes</strong></td>
<td><strong>SWC</strong></td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/RunnableManagement/IncludeHeaders</td>
<td>All of the includes that are required to provide runnable prototypes (e.g. “MyHeader.h”)</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/RunnableManagement/Runnable</td>
<td>All of the runnables that are required in a given project that run at the “MotorControl” or “MotorControlx2” Rate. The shortname needs to exactly match the runnable function name</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/RunnableManagement/Runnable/RunnableRate</td>
<td>Selection of the rate at which the given runnable executes (MotorControl or MotorControlx2)</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/RunnableManagement/Runnable/SequenceOrder</td>
<td>Sequence order number to help define the ordering of the runnables relative to each other. Lower numbers are executed prior to higher numbers. Ordering does not need to be sequential, but it is recommended for clarity. Please note that if all MotorControlx2 runnables are not grouped together, there will be throughput inefficiencies.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/IncludeHeaders</td>
<td>All of the includes that may be required to provide signal initial values (e.g. “MyHeader.h”). This is possibly required if initial values are required to be tied to a global constant that is defined in a certain header for example.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/NonRteEnum</td>
<td>All of the enumeration definitions required outside of the RTE. The short name needs to exactly match the desired enumeration name.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/NonRteEnum/EnumImplementationDataType</td>
<td>Implementation Data Type of the given enumeration. Selection of the supported types of “uint8”, “uint16”, and “uint32”.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/NonRteEnum/EnumElement</td>
<td>Elements of a given enumeration. The short name should be the enumeration element name.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/NonRteEnum/EnumElement/Value</td>
<td>Numeric value of a given enumeration element</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/SignalMapping</td>
<td>Contains the configuration required for mapping differently named signals to eachother. This component specifically requires, at a minimum, all of the mapping of names related to signals that flow into, out of, or through the Motor Control runnables. Recommended “Short Name” of container is “<em>&lt;OutputSignal&gt;</em>Map”</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/SignalMapping/OutputSignalName</td>
<td>Output signal name of signal needing mapping</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/SignalMapping/InputSignalName</td>
<td>Input signal name (or names) of signal needing mapping. Note that it is allowed to map more than one input name to each output.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal</td>
<td>Contains the required details of a given signal. The short name should match the base signal name (excluding “MotCtrl” prefix)</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/EnumerationNameReference</td>
<td>Selection of Enumeration (if applicable - this should only exist on signals that are enumerations). Enumeration needs to be added to “/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/NonRteEnum” configuration before it can be selected.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/ImplementationDataType</td>
<td>Selection of Implementation Data Type of signal. For enumerations, this should be selected to match the underlying enumeration datatype.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/InitialValue</td>
<td>Initial Value, for arrays this should be a comma separated list (e.g. you would enter: 10,20,30,40). Suffixes of “F”, “U”, etc should be on appropriate signals as required.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/Max</td>
<td>Maximum Value as indicated by m file defining signal.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/Min</td>
<td>Minimum Value as indicated by m file defining signal.</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/ReadInMotCtrlRunnable</td>
<td>This flag indicates if a given signal is read in a runnable that runs at “MotorControl” or “MotorControlx2” rate</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/ReadIn2msRunnable</td>
<td>This flag indicates if a given signal is read in a runnable that runs at 2ms (or slower) RTE task</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/WrittenInMotCtrlRunnable</td>
<td>This flag indicates if a given signal is written in a runnable that runs at “MotorControl” or “MotorControlx2” rate</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/WrittenIn2msRunnable</td>
<td>This flag indicates if a given signal is written in a runnable that runs at 2ms (or slower) RTE task</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="even">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/Size</td>
<td>Size of signal. This needs to be 1 for standard signals and if greater than 1, the signal is considered to be an array</td>
<td>MotCtrlMgr</td>
</tr>
<tr class="odd">
<td>/Nexteer/MotCtrlMgr/MotCtrlMgrConfigSet/SignalManagement/Signal/Units</td>
<td>Units of signal as indicated by m file defining signal.</td>
<td>MotCtrlMgr</td>
</tr>
</tbody>
</table>
<h2 id="davinci-interrupt-configuration-changes">DaVinci Interrupt Configuration Changes</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 21%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>ISR Name</strong></td>
<td><strong>Interrupt Category (FE/EI)</strong></td>
<td><strong>Interrupt Channel Number</strong></td>
<td><strong>Priority Dependency</strong></td>
<td><strong>Notes</strong></td>
</tr>
<tr class="even">
<td><strong>MotCtrlMgrIrq</strong></td>
<td>EI</td>
<td>Needs to be gathered from program specific CM###_XXXXMcuCfg_Design component</td>
<td>Needs to be an appropriate priority for the high speed motor control interrupt</td>
<td>This ISR should be category 1 ISR and mapped to trusted application</td>
</tr>
</tbody>
</table>
<h2 id="manual-configuration-changes">Manual Configuration Changes</h2>
<table>
<colgroup>
<col style="width: 39%" />
<col style="width: 47%" />
<col style="width: 12%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td><strong>Notes</strong></td>
<td><strong>SWC</strong></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="integration-dataflow-requirements">Integration DATAFLOW REQUIREMENTS</h1>
<h2 id="required-global-data-inputs">Required Global Data Inputs</h2>
<p>This module defines all non-RTE motor control data structures</p>
<h2 id="required-global-data-outputs">Required Global Data Outputs</h2>
<p>This module defines all non-RTE motor control data structures</p>
<h2 id="specific-include-path-present">Specific Include Path present</h2>
<p>Yes</p>
<h1 id="runnable-scheduling">Runnable Scheduling </h1>
<p>This section specifies the required runnable scheduling.</p>
<table style="width:100%;">
<colgroup>
<col style="width: 25%" />
<col style="width: 54%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Init</strong></td>
<td><strong>Scheduling Requirements</strong></td>
<td><strong>Trigger</strong></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 49%" />
<col style="width: 27%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Runnable</strong></td>
<td><strong>Scheduling Requirements</strong></td>
<td><strong>Trigger</strong></td>
</tr>
<tr class="even">
<td><strong>MotCtrlMgrIrq</strong></td>
<td>None</td>
<td>ISR – exact ISR source to be gathered from program specific CM###_XXXXMcuCfg_Design component</td>
</tr>
<tr class="odd">
<td><strong>MotCtrlMgrPer1</strong></td>
<td>MotCtrlMgrPer1 should execute near the start of the 2ms loop before any other functions that need data that is output by runnables running at the Motor Control rate. The DMA transfer that is populating MotCtrlMgr_TwoMilliSecFromMotCtrl_Rec shall run before MotCtrlMgrPer1 and ideally enough other functionality runs in-between these two events that the transfer can complete with minimal wait time in MotCtrlMgrPer1 (since this function is waiting for DMA transfer completion).</td>
<td>2ms RTE</td>
</tr>
<tr class="even">
<td><strong>MotCtrlMgrPer2</strong></td>
<td>MotCtrlMgrPer2 should execute as the final function of the forward path to allow minimal lag on computation of new PWM commands in the Motor Control loop.</td>
<td>2ms RTE</td>
</tr>
</tbody>
</table>
<p><strong>.</strong></p>
<h1 id="memory-map-requirements">Memory Map REQUIREMENTS</h1>
<h2 id="mapping">Mapping</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 53%" />
<col style="width: 21%" />
<col style="width: 24%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Memory Section</strong></td>
<td><strong>Contents</strong></td>
<td><strong>Notes</strong></td>
</tr>
<tr class="even">
<td><strong>MotCtrl_START_SEC_CODE</strong></td>
<td>Interrupt code</td>
<td>This code section also includes a static function scope variable, and therefore needs to open and close variable mapping statements and this should be mapped to the same application that the ISR is mapped to.</td>
</tr>
<tr class="odd">
<td><strong>CDD_MotCtrlMgr_DmaWrite_START_SEC_VAR_INIT_128</strong></td>
<td>Data that a DMA channel writes to during run-time</td>
<td>This gets mapped to a “.data_dma_128” section that will need to be explicitly added to the linker file. The intent of this section is to be placed in a RAM memory section that only the DMA has write access to (processor in user mode only has read access).</td>
</tr>
</tbody>
</table>
<p>* Each …START_SEC… constant is terminated by a …STOP_SEC… constant as specified in the AUTOSAR Memory Mapping requirements.</p>
<h2 id="usage">Usage</h2>
<table>
<colgroup>
<col style="width: 55%" />
<col style="width: 23%" />
<col style="width: 21%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Feature</strong></td>
<td><strong>RAM</strong></td>
<td><strong>ROM</strong></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="nvm-blocks">NvM Blocks</h2>
<p>None</p>
<h1 id="compiler-settings">Compiler Settings</h1>
<h2 id="preprocessor-macro"> Preprocessor MACRO</h2>
<p>None</p>
<h2 id="optimization-settings">Optimization Settings</h2>
<p>None</p>
<h1 id="appendix">Appendix</h1>
<p><em>&lt;This section is for appendix&gt;</em></p>
