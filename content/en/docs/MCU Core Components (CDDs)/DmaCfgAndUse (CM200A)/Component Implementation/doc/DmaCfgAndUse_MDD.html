---
title: DmaCfgAndUse_MDD
linkTitle: DmaCfgAndUse_MDD
weight: 4
---

<p><strong>Module Design Document</strong></p>
<p><strong>For</strong></p>
<p><strong>DmaCfgAndUse</strong></p>
<p><strong>VERSION:</strong> <strong>3.0</strong></p>
<p><strong>DATE:</strong> <strong>10-Jun-2016</strong></p>
<p><strong>Prepared By:</strong></p>
<p><strong>Avinash James</strong></p>
<p><strong>Location:</strong> The official version of this document is stored in the Nexteer Configuration Management System.</p>
<p><strong>Revision History</strong></p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 13%" />
<col style="width: 19%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Description</strong></td>
<td><strong>Author</strong></td>
<td><strong>Version</strong></td>
<td><strong>Date</strong></td>
</tr>
<tr class="even">
<td>Initial Version</td>
<td>Kathleen Creager</td>
<td>1.0</td>
<td>08-Jun-2015</td>
</tr>
<tr class="odd">
<td>Changes for FDD version CM200A_DmaCfgAndUse_Design_1.4.0</td>
<td>Kathleen Creager</td>
<td>2.0</td>
<td>20-Oct-2015</td>
</tr>
<tr class="even">
<td>Added rationale for diplay variable deviation and also changed the time out time from 100 to 400uSec</td>
<td>Avinash James</td>
<td>3.0</td>
<td>10-Jun-2016</td>
</tr>
</tbody>
</table>
<p>Table of Contents</p>
<p><a href="#abbrevations-and-acronyms">1 Abbrevations And Acronyms 5</a></p>
<p><a href="#references">2 References 6</a></p>
<p><a href="#dmacfganduse-high-level-description">3 DmaCfgAndUse High-Level Description 7</a></p>
<p><a href="#design-details-of-software-module">4 Design details of software module 8</a></p>
<p><a href="#graphical-representation-of-dmacfganduse">4.1 Graphical representation of DmaCfgAndUse 8</a></p>
<p><a href="#data-flow-diagram">4.2 Data Flow Diagram 8</a></p>
<p><a href="#module-level-dfd">4.2.1 Module level DFD 8</a></p>
<p><a href="#sub-module-level-dfd">4.2.2 Sub-Module level DFD 8</a></p>
<p><a href="#component-flow-diagram">4.3 COMPONENT FLOW DIAGRAM 8</a></p>
<p><a href="#variable-data-dictionary">5 Variable Data Dictionary 9</a></p>
<p><a href="#user-defined-typedef-definitiondeclaration">5.1 User defined typedef definition/declaration 9</a></p>
<p><a href="#variable-definition-for-enumerated-types">5.2 Variable definition for enumerated types 9</a></p>
<p><a href="#constant-data-dictionary">6 Constant Data Dictionary 10</a></p>
<p><a href="#programfixed-constants">6.1 Program(fixed) Constants 10</a></p>
<p><a href="#embedded-constants">6.1.1 Embedded Constants 10</a></p>
<p><a href="#local">6.1.1.1 Local 10</a></p>
<p><a href="#global">6.1.1.2 Global 10</a></p>
<p><a href="#module-specific-lookup-tables-constants">6.1.2 Module specific Lookup Tables Constants 10</a></p>
<p><a href="#software-module-implementation">7 Software Module Implementation 11</a></p>
<p><a href="#sub-module-functions">7.1 Sub-Module Functions 11</a></p>
<p><a href="#initialization-functions">7.2 Initialization Functions 11</a></p>
<p><a href="#init-dmacfganduseinit1">7.2.1 Init: DmaCfgAndUseInit1 11</a></p>
<p><a href="#design-rationale">7.2.1.1 Design Rationale 11</a></p>
<p><a href="#module-outputs">7.2.1.2 Module Outputs 11</a></p>
<p><a href="#periodic-functions">7.3 PERIODIC FUNCTIONS 11</a></p>
<p><a href="#per-dmacfganduseper1">7.3.1 Per: DmaCfgAndUsePer1 11</a></p>
<p><a href="#design-rationale-1">7.3.1.1 Design Rationale 11</a></p>
<p><a href="#store-module-inputs-to-local-copies">7.3.1.2 Store Module Inputs to Local copies 11</a></p>
<p><a href="#processing-of-function">7.3.1.3 (Processing of function)……… 11</a></p>
<p><a href="#store-local-copy-of-outputs-into-module-outputs">7.3.1.4 Store Local copy of outputs into Module Outputs 11</a></p>
<p><a href="#non-periodic-functions">7.4 Non PERIODIC FUNCTIONS 11</a></p>
<p><a href="#nonper-dmaena2millisectomotctrltrf_oper">7.4.1 NONPer: DmaEna2MilliSecToMotCtrlTrf_Oper 12</a></p>
<p><a href="#design-rationale-2">7.4.1.1 Design Rationale 12</a></p>
<p><a href="#store-module-inputs-to-local-copies-1">7.4.1.2 Store Module Inputs to Local copies 12</a></p>
<p><a href="#processing-of-function-1">7.4.1.3 (Processing of function)……… 12</a></p>
<p><a href="#store-local-copy-of-outputs-into-module-outputs-1">7.4.1.4 Store Local copy of outputs into Module Outputs 12</a></p>
<p><a href="#nonper-dmawaitformotctrlto2millisectrf_oper">7.4.2 NONPer: DmaWaitForMotCtrlTo2MilliSecTrf_Oper 12</a></p>
<p><a href="#design-rationale-3">7.4.2.1 Design Rationale 12</a></p>
<p><a href="#store-module-inputs-to-local-copies-2">7.4.2.2 Store Module Inputs to Local copies 12</a></p>
<p><a href="#processing-of-function-2">7.4.2.3 (Processing of function)……… 12</a></p>
<p><a href="#store-local-copy-of-outputs-into-module-outputs-2">7.4.2.4 Store Local copy of outputs into Module Outputs 12</a></p>
<p><a href="#interrupt-functions">7.5 Interrupt Functions 12</a></p>
<p><a href="#serial-communication-functions">7.6 Serial Communication Functions 13</a></p>
<p><a href="#local-functionmacro-definitions">7.7 Local Function/Macro Definitions 13</a></p>
<p><a href="#global-functionmacro-definitions">7.8 GLObAL Function/Macro Definitions 13</a></p>
<p><a href="#global-function-1">7.8.1 GLObAL Function #1 13</a></p>
<p><a href="#description">7.8.1.1 Description 13</a></p>
<p><a href="#transient-functions">7.9 TRANSIENT FUNCTIONS 13</a></p>
<p><a href="#unit-test-considerations">8 Unit Test Considerations 14</a></p>
<p><a href="#known-limitations-with-design">9 Known Limitations With Design 15</a></p>
<p><a href="#appendix">10 Appendix 16</a></p>
<h1 id="abbrevations-and-acronyms">Abbrevations And Acronyms</h1>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 71%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Abbreviation</td>
<td>Description</td>
</tr>
<tr class="even">
<td>DFD</td>
<td>Design functional diagram</td>
</tr>
<tr class="odd">
<td>MDD</td>
<td>Module design Document</td>
</tr>
<tr class="even">
<td></td>
<td>&lt;ADD more to the table if applicable&gt;</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="references">References</h1>
<p>This section lists the title &amp; version of all the documents that are referred for development of this document</p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 65%" />
<col style="width: 22%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Sr. No.</td>
<td>Title</td>
<td>Version</td>
</tr>
<tr class="even">
<td>&lt;1&gt;</td>
<td>&lt;MDD Guidelines&gt;</td>
<td>Software Engineering Process 04.00.00</td>
</tr>
<tr class="odd">
<td>&lt;2&gt;</td>
<td>&lt;Software Naming Conventions&gt;</td>
<td>Software Engineering Process 04.00.00 and working EA4 naming conventions</td>
</tr>
<tr class="even">
<td>&lt;3&gt;</td>
<td>&lt;Coding standards&gt;</td>
<td>Software Engineering Process 04.00.00</td>
</tr>
<tr class="odd">
<td>&lt;4&gt;</td>
<td>&lt;FDD &gt;</td>
<td>See Synergy subproject version</td>
</tr>
<tr class="even">
<td></td>
<td>&lt;Add if more available&gt;</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="dmacfganduse-high-level-description">DmaCfgAndUse High-Level Description</h1>
<p>DMA Configuration and Usage (DmaCfgAndUse) sets up the initial DMA configuration and defines the periodic and server runnable functionality needed for DMA transfers of SPI, ADC, and Motor Control loop/RTE interface data.</p>
<h1 id="design-details-of-software-module">Design details of software module</h1>
<p><em>See FDD.</em></p>
<h2 id="graphical-representation-of-dmacfganduse">Graphical representation of DmaCfgAndUse</h2>
<p><img src="ElectricPowerSteering_RH850_GM_T1XX_website/static/media/image1.png" style="width:3.7in;height:2.075in" /></p>
<h2 id="data-flow-diagram">Data Flow Diagram</h2>
<p><em>See FDD.</em></p>
<h2 id="module-level-dfd">Module level DFD</h2>
<p><em>See FDD.</em></p>
<h2 id="sub-module-level-dfd">Sub-Module level DFD</h2>
<p><em>See FDD.</em></p>
<h2 id="component-flow-diagram">COMPONENT FLOW DIAGRAM</h2>
<p><em>NA</em></p>
<h1 id="variable-data-dictionary">Variable Data Dictionary</h1>
<h2 id="user-defined-typedef-definitiondeclaration">User defined typedef definition/declaration </h2>
<p><em>&lt;This section documents any user types uniquely used for the module.&gt;</em></p>
<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Typedef Name</td>
<td>Element Name</td>
<td>User Defined Type</td>
<td><p>Legal Range</p>
<p>(min)</p></td>
<td><p>Legal Range</p>
<p>(max)</p></td>
</tr>
<tr class="even">
<td>MotCtrlFromTwoMilliSecRec1</td>
<td>Generated in MotCtrlMgr component</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>TwoMilliSecToMotCtrlRec1</td>
<td>Generated in MotCtrlMgr component</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="even">
<td>MotCtrlToTwoMilliSecRec1</td>
<td>Generated in MotCtrlMgr component</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>TwoMilliSecFromMotCtrlRec1</td>
<td>Generated in MotCtrlMgr component</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2 id="variable-definition-for-enumerated-types">Variable definition for enumerated types</h2>
<table>
<colgroup>
<col style="width: 44%" />
<col style="width: 40%" />
<col style="width: 14%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Enum Name</td>
<td>Element Name</td>
<td>Value</td>
</tr>
<tr class="even">
<td><p>&lt;(Name given for the user defined typdef of type struct/union)</p>
<p>(Variable name qualified in refer[2])&gt;</p></td>
<td>&lt;(Variable name qualified Refer[2])&gt;</td>
<td>&lt;Define the value &gt;</td>
</tr>
</tbody>
</table>
<h1 id="constant-data-dictionary">Constant Data Dictionary</h1>
<h2 id="programfixed-constants">Program(fixed) Constants</h2>
<h2 id="embedded-constants">Embedded Constants</h2>
<p><em>&lt; All program specific constants will be defined in detail &gt;</em></p>
<h2 id="local">Local</h2>
<table>
<colgroup>
<col style="width: 47%" />
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 16%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Constant Name</td>
<td>Resolution</td>
<td>Units</td>
<td>Value</td>
</tr>
<tr class="even">
<td>CPU1PEID_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>1</td>
</tr>
<tr class="odd">
<td>PRPHLTOLCLRAMSPID_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>3</td>
</tr>
<tr class="even">
<td>LCLRAMTOPRPHLSPID_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>2</td>
</tr>
<tr class="odd">
<td>LCLRAMTOLCLRAMSPID_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>0</td>
</tr>
<tr class="even">
<td>USRMODENA_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>1</td>
</tr>
<tr class="odd">
<td>USRMODDI_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>0</td>
</tr>
<tr class="even">
<td>MAXWAIT_MICROSEC_U32</td>
<td>1</td>
<td>MicroSec</td>
<td>400</td>
</tr>
<tr class="odd">
<td>Also see FDD DataDict.m file</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>INIZERO_CNT_U32</td>
<td>1</td>
<td>Counts</td>
<td>0</td>
</tr>
</tbody>
</table>
<h2 id="global">Global</h2>
<p><em>&lt;This section lists the global constants used by the module. For details on global constants, refer to the Data Dictionary for the application&gt;</em></p>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Constant Name</td>
</tr>
<tr class="even">
<td>See FDD DataDict.m file</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td></td>
</tr>
</tbody>
</table>
<h2 id="module-specific-lookup-tables-constants">Module specific Lookup Tables Constants</h2>
<p><em>&lt;(This is for lookup tables (arrays) with fixed values, same name as other tables)&gt;</em></p>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 20%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Constant Name</td>
<td>Resolution</td>
<td>Value</td>
<td>Software Segment</td>
</tr>
<tr class="even">
<td>&lt;Refer Constant name qualified in [2]&gt;</td>
<td>&lt;Refer MDD guidelines [1]&gt;</td>
<td>&lt;Refer MDD guidelines [1]&gt;</td>
<td>&lt;Refer MDD guidelines [1]&gt;</td>
</tr>
</tbody>
</table>
<h1 id="software-module-implementation">Software Module Implementation</h1>
<h2 id="sub-module-functions">Sub-Module Functions</h2>
<p><em>&lt;(Note: For multiple functions, insert new headers at the “Header 2” level – subset of “ Sub Module Function section above” and follow the same sub-section design shown below . If none required, place the text “None”))&gt;</em></p>
<h2 id="initialization-functions">Initialization Functions</h2>
<p><em>&lt;(Note: For multiple init functions, insert new headers at the “Header 2” level – subset of “ Initialization Function section above” and follow the same sub-section design shown below . If none required, place the text “None”))&gt;</em></p>
<h2 id="init-dmacfganduseinit1">Init: DmaCfgAndUseInit1</h2>
<h2 id="design-rationale">Design Rationale</h2>
<p>The DMACnnCM channel master registers can be written only in supervisor mode. After the Channel master register for a given channel has been written, the selected Processor Element can write to that channel’s registers in user mode. However, for simplicity, all DMA register initialization is being done in one trusted function. Therefore, only the Per Instance Memory initialization is done directly in the DmaCfgAndUseInit1 function; all DMA register initialization is done in the DmaRegInin function called by DmaCfgAndUseInit1.</p>
<h2 id="module-outputs">Module Outputs</h2>
<p><em>See FDD.</em></p>
<h2 id="periodic-functions">PERIODIC FUNCTIONS </h2>
<h2 id="section"></h2>
<p><em>(Note: For multiple periodic functions, insert new headers at the “Header 2” level – subset of “7.3 Periodic Functions” and follow the same sub-section design shown below). If none required, place the text “None”)&gt;</em></p>
<h2 id="per-dmacfganduseper1">Per: DmaCfgAndUsePer1</h2>
<h2 id="design-rationale-1">Design Rationale</h2>
<p><em>None</em></p>
<h2 id="store-module-inputs-to-local-copies">Store Module Inputs to Local copies</h2>
<p><em>None</em></p>
<h2 id="processing-of-function">(Processing of function)………</h2>
<p><em>See FDD.</em></p>
<h2 id="store-local-copy-of-outputs-into-module-outputs">Store Local copy of outputs into Module Outputs</h2>
<p><em>None</em></p>
<h2 id="non-periodic-functions">Non PERIODIC FUNCTIONS </h2>
<h2 id="section-1"></h2>
<h2 id="nonper-dmaena2millisectomotctrltrf_oper">NONPer: DmaEna2MilliSecToMotCtrlTrf_Oper</h2>
<h2 id="design-rationale-2">Design Rationale</h2>
<p><em>None</em></p>
<h2 id="store-module-inputs-to-local-copies-1">Store Module Inputs to Local copies</h2>
<p><em>None</em></p>
<h2 id="processing-of-function-1">(Processing of function)………</h2>
<p><em>See FDD</em></p>
<h2 id="store-local-copy-of-outputs-into-module-outputs-1">Store Local copy of outputs into Module Outputs</h2>
<p><em>None</em></p>
<h2 id="nonper-dmawaitformotctrlto2millisectrf_oper">NONPer: DmaWaitForMotCtrlTo2MilliSecTrf_Oper</h2>
<h2 id="design-rationale-3">Design Rationale</h2>
<p><em>None</em></p>
<h2 id="store-module-inputs-to-local-copies-2">Store Module Inputs to Local copies</h2>
<p><em>None</em></p>
<h2 id="processing-of-function-2">(Processing of function)………</h2>
<p><em>See FDD</em></p>
<h2 id="store-local-copy-of-outputs-into-module-outputs-2">Store Local copy of outputs into Module Outputs</h2>
<p><em>None</em></p>
<h2 id="interrupt-functions">Interrupt Functions</h2>
<p><em>None</em></p>
<h2 id="serial-communication-functions">Serial Communication Functions</h2>
<p><em>None</em></p>
<h2 id="local-functionmacro-definitions">Local Function/Macro Definitions</h2>
<p>None</p>
<h2 id="global-functionmacro-definitions">GLObAL Function/Macro Definitions</h2>
<p>&lt;If these are numerous and defined in a separate source file then reference the source file only.&gt;</p>
<h2 id="global-function-1">GLObAL Function #1</h2>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 42%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Function Name</strong></td>
<td>DmaRegInin</td>
<td>Type</td>
<td>Min</td>
<td>Max</td>
</tr>
<tr class="even">
<td><strong>Arguments Passed</strong></td>
<td>None</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Return Value</strong></td>
<td>N/A</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="description">Description</h2>
<p>Trusted function that performs all register initialization from the CM200A_DmaCfgAndUse_PeripheralCfg.xlsx spreadsheet in the FDD. The DMACnnCM channel master registers can be written only in supervisor mode. After the Channel master register for a given channel has been written, the selected Processor Element can write to that channel’s registers in user mode. However, for simplicity, all DMA register initialization is being done in one trusted function. For timing optimization, register level initialization is used (rather than bit field modifications of the register fields).</p>
<h2 id="transient-functions">TRANSIENT FUNCTIONS </h2>
<p><em>None</em></p>
<h1 id="unit-test-considerations">Unit Test Considerations</h1>
<p>None</p>
<h1 id="known-limitations-with-design">Known Limitations With Design</h1>
<p>There is a deviation from the coding standards for use of display variables which are used only for storing values needed for test purpose. However we have used display variable to compare with a measured parameter and assign value to the diplay variable based on the comparison. This deviation is okay as creating an additional per instance memory for this purpose is redundant and hence have deviated from the coding standards</p>
<h1 id="appendix">Appendix</h1>
<p><em>&lt;This section is for appendix&gt;</em></p>
